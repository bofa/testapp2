angular.module("myapp.deviceEventsRealTime",[]).config(["c8yViewsProvider",function(a){a.when("/device/:deviceId",{name:"Real-Time Events",icon:"rss",templateUrl:"/apps/myapp99/deviceEventsRealTime/views/deviceEventsRealTime.html",controller:"deviceEventsRealTimeCtrl"})}]),angular.module("myapp.deviceEventsRealTime").controller("deviceEventsRealTimeCtrl",["$scope","$routeParams","c8yNotifications","c8yAlert","c8yCepModule",function(a,b,c,d,e){function f(){i||e.createOrDeploy(l).then(c.configure).then(angular.bind({},c.subscribe,k)).then(function(a){d.success("Connected! Waiting for incoming events..."),i=a,i.$on("message",g)})}function g(b,c){for(a.events.push(c);a.events.length>100;)a.events.shift()}function h(){i&&i.unsubscribe&&i.unsubscribe()}var i,j=b.deviceId,k="/events/"+j,l={name:"c8yui_realtime_device_events",body:'insert into\n  SendNotification\nselect\n  e.event as payload,\n  "events/" || e.event.source.value as channelName\nfrom\n  EventCreated e;',status:"DEPLOYED"};a.events=[],a.$on("$destroy",h),f()}]),angular.module("myapp.deviceEventsRealTime").run(["$templateCache",function(a){"use strict";a.put("/apps/myapp99/deviceEventsRealTime/views/deviceEventsRealTime.html",'<div><div class="alert alert-warning" ng-show="events.length === 0">No incoming events at the moment...</div><table class="table table-hover"><tr ng-repeat="e in events|orderBy:\'id\':true"><td style=width:30px class=text-center><span class=badge>{{e.data.type}}</span></td><td>{{e.data.text || \'-- no text message --\'}} <small class="text-muted hidden-sm hidden-xs" style=margin-right:10px><strong>Created:</strong> {{e.data.creationTime|date:\'medium\'}}</small> <small class="text-muted hidden-sm hidden-xs"><strong>Data:</strong> {{e.data|json}}</small></td></tr></table></div>')}]);